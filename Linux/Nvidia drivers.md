# Nvidia Drivers

Nvidia is kinda a bitch to set up to work for multiple monitors and stuff.

### Basic setup

1. Install `nvidia` package and its dependencies onto your system.
2. Install `nvidia settings` package too for a settings window.

If you go and restart your system you may find that the system hangs at 'reached graphical target'.
This is likely due to your `/etc/X11/xorg.conf` no longer playing nice with the nvidia drivers.
Confirm this by changing tty on the boot screen (ctrl+alt+f2) and checking your display manage is not working `systemctl status sddm`. Also run `journalctl` and have a look at the errors that were reported. In my case sddm had a 'core dump' and failed to fetch a display.

Temporaraly fix this error by running `sudo nvidia-xconfig` to overwrite your old xorg.conf with a new one generated by nvidia that plays nice with X and nvidia drivers. You should now restart and you should reach the display manager and desktop.

### Ditching nvidia config files for xrandr to fix screen tearing and monitor layout

Nvidia drivers might also break your monitor setup and create screen tearing. especially when with multihead setups.
While you can modify the */etc/X11/xorg.conf* and */etc/X11/xorg.conf.d/20-nvidia.conf* Files i am yet to solve the screen tearing and layout propperly with these configs.

The current way i am setting up my displays is with xrandr. This command will fully set up my monitors (and belongs in the .xinitrc when using startx):
`xrandr --output HDMI-0 --mode 1920x1080 --pos 1080x420 --output HDMI-1 --primary --mode 1920x1080 --pos 0x0 --rotate left`
Here are my other config files which currently dont do anything but i will still include for completeness sake

```none
|-- xinitrc.d
|   |-- 05-device.conf
|   `-- 10-monitor.conf
`-- xserverrc
```

```none
# /etc/X11/xinit/xinitrc.d/05-device.conf
Section "Device"
    Identifier "nvidia"
    Driver "nvidia"
    Option "Monitor-HDMI-0" "HDMI-0-monitor"
    Option "Monitor-HDMI-1" "HDMI-1-monitor"
EndSection
```

```none
# /etc/X11/xinit/xinitrc.d/10-monitor.conf
Section "Monitor"
    Identifier "HDMI-0-monitor"
EndSection

Section "Monitor"
    Identifier "HDMI-1-monitor"
    Option "Rotate" "Left"
    Option "RightOf " "HDMI-0-monitor"
EndSection
```

### CLI configure displays

`nvidia-settings --assign CurrentMetaMode="HDMI-0: nvidia-auto-select +1080+420 {ForceCompositionPipeline=On}, HDMI-1: nvidia-auto-select +0+0{ForceCompositionPipeline=On, Rotation=90, primary=true}"`
